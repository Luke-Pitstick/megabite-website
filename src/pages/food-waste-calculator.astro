---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Food Waste Calculator | Restaurant Inventory Savings" 
  description="Calculate how much money your restaurant is losing to food waste and discover your potential savings with integrated inventory management."
>
  <section class="py-12 sm:py-20 bg-gradient-to-br from-primary-50 via-white to-primary-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 overflow-x-hidden">
      <div class="text-center mb-8 sm:mb-12 scroll-animate">
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 animate-scale">
          <span class="bg-gradient-to-r from-primary-600 to-primary-500 bg-clip-text text-transparent">
            Food Waste Calculator
          </span>
        </h1>
        <p class="text-lg sm:text-xl text-gray-600 animate-fade-in delay-200">
          See how much profit is rotting in your walk-in
        </p>
      </div>

      <div class="bg-white rounded-2xl shadow-xl p-4 sm:p-8 card-entrance">
        <div class="bg-secondary-50 border-l-4 border-secondary-500 p-4 mb-6 rounded-r">
          <p class="text-secondary-900 font-semibold">⚠️ Industry Data:</p>
          <p class="text-secondary-800 text-sm mt-1">The average restaurant wastes 4-10% of food purchased. Quick-service: ~4-6%, Full-service: ~6-10%</p>
        </div>

        <form id="waste-calculator" class="space-y-6">
          <!-- Monthly Food Costs -->
          <div class="scroll-animate">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Monthly Food Purchases
            </label>
            <div class="relative">
              <span class="absolute left-4 top-3 text-gray-500">$</span>
              <input 
                type="number" 
                id="food-purchases"
                placeholder="30000"
                class="w-full pl-8 pr-4 py-3 rounded-lg border-2 border-gray-200 focus:border-primary-500 focus:outline-none text-lg"
                required
              />
            </div>
          </div>

          <!-- Estimated Waste % -->
          <div class="scroll-animate">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Estimated Food Waste %
            </label>
            <input 
              type="range" 
              id="waste-percent"
              min="0"
              max="15"
              value="8"
              step="0.5"
              class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary-500"
            />
            <div class="flex justify-between text-sm text-gray-600 mt-2">
              <span>0%</span>
              <span id="waste-display" class="font-bold text-primary-600">8%</span>
              <span>15%</span>
            </div>
            <p class="mt-2 text-sm text-gray-500">Don't know? Use the industry average of 8%</p>
          </div>

          <!-- Do you track inventory? -->
          <div class="scroll-animate">
            <label class="block text-sm font-semibold text-gray-700 mb-3">
              How do you currently track inventory?
            </label>
            <div class="space-y-2">
              <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-300 transition-colors">
                <input type="radio" name="tracking" value="none" class="mr-3 accent-primary-500" checked />
                <span>No formal tracking (clipboards/estimates)</span>
              </label>
              <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-300 transition-colors">
                <input type="radio" name="tracking" value="spreadsheet" class="mr-3 accent-primary-500" />
                <span>Spreadsheets</span>
              </label>
              <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-primary-300 transition-colors">
                <input type="radio" name="tracking" value="basic" class="mr-3 accent-primary-500" />
                <span>Basic inventory software</span>
              </label>
            </div>
          </div>

          <!-- Calculate Button -->
          <button 
            type="submit"
            class="w-full bg-gradient-to-r from-primary-500 to-primary-600 text-white px-8 py-4 rounded-full text-lg font-semibold hover:shadow-xl transition-all duration-300 hover:scale-105 btn-shimmer"
          >
            Calculate Waste & Savings
          </button>
        </form>

        <!-- Results Section -->
        <div id="results" class="hidden mt-8 space-y-6">
          <div class="border-t-2 border-gray-200 pt-6">
            <h3 class="text-2xl font-bold text-gray-900 mb-6">Your Food Waste Analysis</h3>
            
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
              <!-- Monthly Waste -->
              <div class="bg-gradient-to-br from-red-50 to-white p-4 md:p-6 rounded-xl border border-red-100 text-center">
                <p class="text-xs md:text-sm font-semibold text-red-600 mb-2">MONTHLY WASTE</p>
                <p class="text-2xl md:text-3xl font-bold text-red-700 break-words" id="monthly-waste">$0</p>
              </div>

              <!-- Annual Waste -->
              <div class="bg-gradient-to-br from-orange-50 to-white p-4 md:p-6 rounded-xl border border-orange-100 text-center">
                <p class="text-xs md:text-sm font-semibold text-orange-600 mb-2">ANNUAL WASTE</p>
                <p class="text-2xl md:text-3xl font-bold text-orange-700 break-words" id="annual-waste">$0</p>
              </div>

              <!-- Potential Savings -->
              <div class="bg-gradient-to-br from-primary-50 to-white p-4 md:p-6 rounded-xl border border-primary-100 text-center">
                <p class="text-xs md:text-sm font-semibold text-primary-600 mb-2">RECOVERABLE (50%)</p>
                <p class="text-2xl md:text-3xl font-bold text-primary-700 break-words" id="savings">$0</p>
              </div>
            </div>

            <!-- Solutions -->
            <div class="bg-gradient-to-r from-secondary-900 to-secondary-800 p-6 rounded-xl text-white">
              <h4 class="text-xl font-bold mb-4">How Integrated Inventory Reduces Waste</h4>
              <ul class="space-y-3">
                <li class="flex items-start">
                  <svg class="w-6 h-6 text-primary-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span><strong>Real-time tracking:</strong> Know exactly what you have, when it expires</span>
                </li>
                <li class="flex items-start">
                  <svg class="w-6 h-6 text-primary-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span><strong>Auto-ordering:</strong> Never over-purchase based on actual usage</span>
                </li>
                <li class="flex items-start">
                  <svg class="w-6 h-6 text-primary-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span><strong>Recipe costing:</strong> Portion control and accurate plate costs</span>
                </li>
                <li class="flex items-start">
                  <svg class="w-6 h-6 text-primary-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  <span><strong>Variance tracking:</strong> Catch theft and prep mistakes immediately</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- CTA Section Below -->
        <div id="waste-cta-section" class="hidden mt-8 bg-gradient-to-br from-primary-500 to-primary-600 p-6 md:p-8 rounded-xl text-white text-center">
          <h4 class="text-xl md:text-2xl font-bold mb-2">Stop Throwing Money in the Trash</h4>
          <p class="mb-4 opacity-90">Get a free audit of your inventory management system</p>
          <a href="/schedule" class="inline-block bg-white text-primary-600 px-8 py-3 rounded-full font-semibold hover:shadow-lg transition-all duration-300 hover:scale-105">
            Schedule Free Consultation
          </a>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  // Update waste percentage display
  const wasteSlider = document.getElementById('waste-percent') as HTMLInputElement;
  const wasteDisplay = document.getElementById('waste-display');
  
  wasteSlider?.addEventListener('input', function() {
    if (wasteDisplay) {
      wasteDisplay.textContent = this.value + '%';
    }
  });

  // Calculator logic
  document.getElementById('waste-calculator')?.addEventListener('submit', function(e) {
    e.preventDefault();

    const foodPurchases = parseFloat((document.getElementById('food-purchases') as HTMLInputElement).value);
    const wastePercent = parseFloat(wasteSlider.value);
    const trackingMethod = (document.querySelector('input[name="tracking"]:checked') as HTMLInputElement)?.value;

    // Calculate waste
    const monthlyWaste = (foodPurchases * wastePercent) / 100;
    const annualWaste = monthlyWaste * 12;
    
    // Estimate potential savings based on tracking method
    let savingsMultiplier = 0.5; // Default 50% recoverable
    if (trackingMethod === 'none') {
      savingsMultiplier = 0.6; // More opportunity with no tracking
    } else if (trackingMethod === 'spreadsheet') {
      savingsMultiplier = 0.5;
    } else if (trackingMethod === 'basic') {
      savingsMultiplier = 0.3; // Already have some system
    }

    const potentialSavings = annualWaste * savingsMultiplier;

    // Update results
    document.getElementById('monthly-waste')!.textContent = `$${monthlyWaste.toLocaleString('en-US', {maximumFractionDigits: 0})}`;
    document.getElementById('annual-waste')!.textContent = `$${annualWaste.toLocaleString('en-US', {maximumFractionDigits: 0})}`;
    document.getElementById('savings')!.textContent = `$${potentialSavings.toLocaleString('en-US', {maximumFractionDigits: 0})}`;

    // Show results
    const results = document.getElementById('results');
    const ctaSection = document.getElementById('waste-cta-section');
    results?.classList.remove('hidden');
    results?.classList.add('animate-slide-up');
    ctaSection?.classList.remove('hidden');
    results?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  });
</script>
